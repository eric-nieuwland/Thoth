<html>
<head>
    <!-- standard elements -->
    <style>
        table {
            border-collapse: collapse;
            border-spacing: 0px 6px;
            margin: 24px 0px;
        }
        th, td {
            vertical-align: top;
            padding: 4px;
        }
        ul {
            list-style-type: "- ";
        }
    </style>
    <!-- custom classes -->
    <style>
        .driver-table {
            margin: 6px;
        }
        .blue-box {
            background-color: #DDE8F6;
            margin: 0px -1px;
            padding: 1px;
        }
        .norm-title {
            margin: 1em 0px;
            padding: 4px 6px;
            font-weight: bold;
            font-size: larger;
            color: white;
            background-color: #325899;
        }
        .norm-intro {
            font-style: italic;
        }
        .part {
            margin: 0px 6px;
        }
        .sub-part {
            margin: 1em 6px;
        }
        .sub-sub-part {
            margin: 1em 0px;
        }
        .part-title,
        .sub-part-title,
        .sub-sub-part-title {
            margin: 1em 0px;
            font-weight: bold;
        }
        td > .part-title,
        td > .sub-part-title,
        td > .sub-sub-part-title {
          margin: 0px;
        }
        .part-title {
            font-size: larger;
        }
        .sub-part-title {
            font-size: medium;
        }
        .sub-sub-part-title {
            font-size: medium;
            color: #2E5E7E;
        }
        .indicator-title {
            padding: 4px 6px;
            margin: 6px 0px;
            color: white;
            background-color: #325899;
        }
        .reference {
        }
    </style>
    <style>
        .footer {
            font-size: 50%;
            margin-top: 16px;
        }
    </style>
</head>
<body>
<div class="norm-title">
SSD4-02 - Secure storage of data
</div>
<div class="norm-intro">
Access to a data store must be prevented or limited, assuming that data storage is also physically protected. Sensitive data must be protected from unauthorized access by encrypting it. If access to the original data is not required (such as passwords), legibility should be made impossible by correctly applying a hash to the data. In that case, a mathematical derivative (the hash) is compared instead of the original.
</div>
<div class="part">
<div class="part-title">
scope
</div>
Data at rest.
</div>
<div class="part">
<div class="part-title">
triggers
</div>
<ul>
<li>Storage of sensitive information.</li>
</ul>
</div>
<div class="blue-box">
<div class="part">
<div class="part-title">
criteria
</div>
<ul>
<li>Protect data in such a way that attacker cannot read, change or delete data. Use access control, encryption, backups and data minimization techniques.</li>
</ul>
</div>
</div>
<div class="blue-box">
<div class="part">
<div class="part-title">
objectives
</div>
<ul>
<li>Authorization of access to stored data prevents unauthorized access.</li>
<li>Encryption prevents access in case access is granted to the database or file system.</li>
</ul>
</div>
</div>
<div class="blue-box">
<div class="part">
<div class="part-title">
risks
</div>
<ul>
<li>Attackers can access stored data that they should not be able to access. This can lead to information disclosure, tampering and denial of service.</li>
</ul>
</div>
</div>
<div class="part">
<div class="part-title">
drivers
</div>
<table width="100%">
<tr>
<td width="*">
<div class="sub-part-title">
NCSC
</div>
<table class="driver-table">
<tr>
<td>
B.04
</td>
</tr>
<tr>
<td>
U/WA.05
</td>
</tr>
<tr>
<td>
U/PW.03
</td>
</tr>
</table>
</td>
<td width="25%">
<div class="sub-part-title">
NIST
</div>
</td>
<td width="25%">
<div class="sub-part-title">
ISO27002:2022
</div>
<table class="driver-table">
<tr>
<td>
8.48.24
</td>
</tr>
<tr>
<td>
8.31.1
</td>
</tr>
<tr>
<td>
8.15
</td>
</tr>
<tr>
<td>
5.8.1
</td>
</tr>
<tr>
<td>
5.34.1
</td>
</tr>
</table>
</td>
<td width="25%">
<div class="sub-part-title">
BIO:2022
</div>
</td>
</tr>
</table>
</div>
<div class="part">
<div class="part-title">
indicators
</div>
<div class="sub-part">
<div class="indicator-title">
01 Identified
</div>
The classification, associated risks, and protective measures have been determined.
<div class="sub-sub-part">
<div class="sub-sub-part-title">
Conformity indicators
</div>
<table>
<tr>
<td>
01/01
</td>
<td>
The classification of data is determined by the data owner, e.g. by performing a DPIA.
</td>
</tr>
<tr>
<td>
01/02
</td>
<td>
The data has been classified by assessing its type, sensitivity, value, and the associated risks.
</td>
</tr>
<tr>
<td>
01/03
</td>
<td>
Appropriate protection measures to maintain the confidentiality, integrity, and availability of the data.
</td>
</tr>
</table>
</div>
<div class="sub-sub-part">
<div class="sub-sub-part-title">
Explanation
</div>
If personal data is stored, a Data Protection Impact Assessment (DPIA) may be required because of the following reasons, and more: consent may be required, individuals may need to be informed, storage may not be allowed, retention restrictions may apply and anonymization may be required. The purpose of a DPIA is to assess the risks related to handling personal information and to determine appropriate protection measures. This process also helps to ensure compliance with relevant industry standards, laws and regulations like GDPR, ISO27002 or BIO (for Dutch governments).
</div>
</div>
<div class="sub-part">
<div class="indicator-title">
02 Protected
</div>
<div class="sub-sub-part">
Sensitive data is protected against unauthorized access and tampering.
</div>
<div class="sub-sub-part">
<div class="sub-sub-part-title">
Conformity indicators
</div>
<table>
<tr>
<td>
02/01
</td>
<td>
Ensure that session identifiers do not end up in logs and error messages.
</td>
</tr>
<tr>
<td/>
<td>
<em>See SSD-30 Application logging.</em>
</td>
</tr>
<tr>
<td>
02/02
</td>
<td>
Access to personal data needs to be limited to only those that need it (need-to-know).
</td>
</tr>
<tr>
<td/>
<td>
<em>See authorize access.</em>
</td>
</tr>
<tr>
<td>
02/03
</td>
<td>
Use encryption to protect data against information disclosure.
</td>
</tr>
<tr>
<td/>
<td>
<em>Consider implementing encryption at different layers (like application, database and filesystem).</em>
</td>
</tr>
<tr>
<td>
02/04
</td>
<td>
The data is encrypted by default, unless the classification of confidentiality and integrity indicates it is not required.
</td>
</tr>
<tr>
<td>
02/05
</td>
<td>
Choose an algorithm that is well-tested, reviewed and free of known weaknesses.
</td>
</tr>
<tr>
<td/>
<td>
<em>Use it with parameters (key size etc.) that are strong enough. For example AES-GCM 256 for storage.</em>
</td>
</tr>
<tr>
<td>
02/06
</td>
<td>
Implement measures to detect tampering in case integrity of the data has been assessed as high risk.
</td>
</tr>
<tr>
<td/>
<td>
<em>Such as monitoring checksums, digital signatures, and audit logs (see application logging) to ensure data integrity.</em>
</td>
</tr>
</table>
</div>
<div class="sub-sub-part">
<div class="sub-sub-part-title">
Explanation
</div>
Encryption that only takes place at disk level or database level gives limited guarantees if that storage is shared with other applications or users. The most important consideration is that a breach in one place cannot lead to access to all data. A risk analysis can provide the necessary clarity here.
</div>
</div>
<div class="sub-part">
<div class="indicator-title">
03 Minimized
</div>
<div class="sub-sub-part">
Collect and retain only the minimum amount of personal data necessary for a specific purpose.
</div>
<div class="sub-sub-part">
<div class="sub-sub-part-title">
Conformity indicators
</div>
<table>
<tr>
<td>
03/01
</td>
<td>
Only store data that is necessary for a specific purpose, only until that purpose no longer exists.
</td>
</tr>
<tr>
<td>
03/02
</td>
<td>
Minimize the amount of sensitive data that you store, and the time that you store it.
</td>
</tr>
<tr>
<td/>
<td>
<em>Meaning the shortest period necessary for its intended purpose and the period required by law or regulation.</em>
</td>
</tr>
<tr>
<td>
03/03
</td>
<td>
Make sure that the collection of that data is transparent to the individuals involved.
</td>
</tr>
<tr>
<td>
03/04
</td>
<td>
If the purpose changes to archiving for data analysis, then aggregation and anonymization are in order.
</td>
</tr>
</table>
</div>
<div class="sub-sub-part">
<div class="sub-sub-part-title">
Explanation
</div>
The idea of data minimization is to collect, process and store the minimum necessary personal information for a specific purpose only. Measures to do this include preventing caching of data, preventing storage of sensitive / personal data on the user side (e.g. local storage, IndexedDB), as well as cleaning legitimate storage on the user side after termination of a session.
</div>
</div>
</div>
<div class="part">
<div class="part-title">
references
</div>
<div class="sub-part">
<div class="reference">
OpenCRE secure data storage - <a href="https://www.opencre.org/cre/126-668">https://www.opencre.org/cre/126-668</a>
</div>
<ul>
<li>The good stuff, right there at your fingertips.</li>
</ul>
</div>
<div class="sub-part">
<div class="reference">
OWASP WSTG Weak Cryptography - <a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/09-Testing_for_Weak_Cryptography/">https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/09-Testing_for_Weak_Cryptography/</a>
</div>

</div>
<div class="sub-part">
<div class="reference">
OWASP cheat sheet password storage - <a href="https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html</a>
</div>

</div>
<div class="sub-part">
<div class="reference">
OWASP cheat sheet database security - <a href="https://cheatsheetseries.owasp.org/cheatsheets/Database_Security_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Database_Security_Cheat_Sheet.html</a>
</div>

</div>
<div class="sub-part">
<div class="reference">
OWASP cheat sheet cryptographic storage - <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html</a>
</div>

</div>
</div>
<div class="footer">
rendered by Thoth on 2025/04/09 at 07:33 in 'en' from ssd4-02.yaml
</div>
</body>
</html>